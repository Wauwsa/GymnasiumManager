{% extends 'layout.html' %}
{% load main_extra %}

{% block body %}
    <main>
        <div class="personal-info">
            <h1>
                <u>Persönliche Informationen:</u>
            </h1>
            <p>
                {% if user.first_name|length > 0 and user.last_name|length > 0 %}
                    Name: {{ user.first_name }} {{ user.last_name }}
                    {% else %}
                    Name: <strong>Kein Name angegeben, bitte wenden Sie sich an ihren Administrator!</strong>
                {% endif %}
                <br>
                {% if user.klasse %}
                    Klasse: {{ user.klasse }}
                    <br>
                {% endif %}
                {% if user.email|length > 0 %}
                    E-Mail: {{ user.email }}
                    {% else %}
                    E-Mail: <strong>Keine E-Mail angegeben, bitte wenden Sie sich an ihren Administrator!</strong>
                {% endif %}
                <br>
                Adresse: {{ user.return_address }}
                <br>
                {% if user.get_age > 10 %}
                    Alter: {{ user.get_age }} Jahre
                {% else %}
                    Alter: <strong>Kein Alter angegeben, bitte wenden Sie sich an ihren Administrator!</strong>
                {% endif %}
                {% if user.is_teacher %}
                    {% if user|get_subjects_of_teacher != None %}
                        <br>
                        Deine Fächer: {{ user|get_subjects_of_teacher }}
                    {% endif %}
                {% endif %}
            </p>
            {% if not user.is_teacher %}
            <h1>
                <u>Neueste Noten:</u>
            </h1>
            {% if recent_grades %}
                {% for grade in recent_grades %}
                    <button class="{{ recent_grades|get_class_button:grade }}" type="button" onclick="collapse_show_button(this)">
                        <strong>{{ grade.Note }}</strong> ({{ grade.Fach }})
                    </button>
                    <div class="content">
                        <div class="content-text">
                            <p>
                                {% if grade.Thema != None %}Thema: {{ grade.Thema }}<br>{% endif %}
                                Datum: {{ grade.Datum }}
                                <br>
                                Gewichtung: {{ grade.Gewichtung }}
                                {% if student.klasse|get_avg_class:grade.Thema %}
                                    <br>
                                    Klassenschnitt: {{ student.klasse|get_avg_class:grade.Thema }}
                                {% endif %}
                            </p>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <p>Du hast noch keine Noten!</p>
            {% endif %}
            {% endif %}
        </div>

            <div class="chartBox">
      <canvas id="myChart"></canvas>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
      const ctx = document.getElementById('myChart');

      new Chart(ctx, {
        type: 'radar',
        data: {
          labels: ['Deutsch', 'Englisch', 'Französisch', 'Mathematik', 'Physik', 'PAM', 'Geografie', 'Geschichte', 'Biologie', 'Chemie', 'BG'],
          datasets: [{
            label: '2022 Noten',
            data: [6, 5, 3, 4.5, 2, 3, 3.75, 1, 4, 4.75, 5.5],
            borderWidth: 1
          },{
          label: '2021 Noten',
          data: [5, 5, 4, 3.5, 3, 3, 4.75, 4, 4.75, 5, 5],
          borderWidth: 0.5
          }]
        },
        options: {
          maintainAspectRatio: false,
          scales: {
            r: {
              beginAtZero: true
            }
          }
        }
      });
    </script>

    </main>

{% endblock %}
